/**!
 * p5.grain
 * 
 * @version 0.6.1
 * @license MIT
 * @copyright meezwhite, Gorilla Sun
 */
class P5Grain{version="0.6.1";#e;#t;#i;instanceMode=!1;instanceRef;constructor(){this.#e=Math.random,this.#t={frameCount:0},this.#i={frameCount:0,tX_anchor:0,tX:0,tY:0}}setup(e){void 0===e?this.#e=random:"object"==typeof e&&("function"==typeof e.random&&(this.#e=e.random),"boolean"==typeof e.instanceMode&&(this.instanceMode=e.instanceMode),"object"==typeof e.instanceRef&&(this.instanceRef=e.instanceRef,this.instanceRef.p5grain=this))}granulateSimple(e,t,i){const n=this.instanceMode?this.instanceRef.round(e):round(e),s=t||!1;i?i.loadPixels():this.instanceMode?this.instanceRef.loadPixels():loadPixels();const a=i?i.pixelDensity():this.instanceMode?this.instanceRef.pixelDensity():pixelDensity(),h=(this.instanceMode?this.instanceRef.width:width)*a*4*((this.instanceMode?this.instanceRef.height:height)*a),o=i?i.pixels:this.instanceMode?this.instanceRef.pixels:pixels;for(let e=0;e<h;e+=4){const t=this.#n(-n,n);o[e]=o[e]+t,o[e+1]=o[e+1]+t,o[e+2]=o[e+2]+t,s&&(o[e+3]=o[e+3]+t)}i?i.updatePixels():this.instanceMode?this.instanceRef.updatePixels():updatePixels()}granulateChannels(e,t,i){const n=round(e),s=t||!1;i?i.loadPixels():this.instanceMode?this.instanceRef.loadPixels():loadPixels();const a=i?i.pixelDensity():this.instanceMode?this.instanceRef.pixelDensity():pixelDensity(),h=(this.instanceMode?this.instanceRef.width:width)*a*4*((this.instanceMode?this.instanceRef.height:height)*a),o=i?i.pixels:this.instanceMode?this.instanceRef.pixels:pixels;for(let e=0;e<h;e+=4)o[e]=o[e]+this.#n(-n,n),o[e+1]=o[e+1]+this.#n(-n,n),o[e+2]=o[e+2]+this.#n(-n,n),s&&(o[e+3]=o[e+3]+this.#n(-n,n));i?i.updatePixels():this.instanceMode?this.instanceRef.updatePixels():updatePixels()}tinkerPixels(e,t,i){t=!1!==t,i?i.loadPixels():this.instanceMode?this.instanceRef.loadPixels():loadPixels();const n=i?i.pixelDensity():this.instanceMode?this.instanceRef.pixelDensity():pixelDensity(),s=(this.instanceMode?this.instanceRef.width:width)*n*4*((this.instanceMode?this.instanceRef.height:height)*n);for(let t=0;t<s;t+=4)e(t,s);t&&(i?i.updatePixels():this.instanceMode?this.instanceRef.updatePixels():updatePixels())}textureAnimate(e,t){const i=t&&t.atFrame?this.instanceMode?this.instanceRef.round(t.atFrame):round(t.atFrame):2;if(this.#t.frameCount+=1,this.#t.frameCount>=i){const i=t&&t.amount?this.instanceMode?this.instanceRef.round(t.amount):round(t.amount):this.instanceMode?this.instanceRef.min(this.instanceMode?this.instanceRef.width:width,this.instanceMode?this.instanceRef.height:height):min(width,height),n=this.instanceMode?this.instanceRef.floor(this.#e()*i):floor(this.#e()*i),s=this.instanceMode?this.instanceRef.floor(this.#e()*i):floor(this.#e()*i),a=`${n}px ${s}px`;e instanceof HTMLElement?e.style.backgroundPosition=a:e instanceof SVGElement?(e.style.top=-s+"px",e.style.left=-n+"px"):e instanceof p5.Element&&e.style("background-position",a),this.#t.frameCount=0}}textureOverlay(e,t,i){const n=i instanceof p5.Graphics,s=n?i.width:this.instanceMode?this.instanceRef.width:width,a=n?i.height:height,h=t&&t.mode?t.mode:this.instanceMode?this.instanceRef.MULTIPLY:MULTIPLY,o=!(!t||!t.reflect)&&t.reflect,c=!(!t||!t.animate)&&t.animate,d=t&&t.animate&&t.animate.atFrame?round(t.animate.atFrame):2,r=t&&t.animate&&t.animate.amount?this.instanceMode?this.instanceRef.round(t.animate.amount):round(t.animate.amount):this.instanceMode?this.instanceRef.min(s,a):min(s,a),l=t&&"number"==typeof t.width?t.width:e.width,f=t&&"number"==typeof t.height?t.height:e.height;c&&(this.#i.frameCount+=1,this.#i.frameCount>=d&&(this.#i.tX_anchor=this.instanceMode?-this.instanceRef.floor(this.#e()*r):-floor(this.#e()*r),this.#i.tY=this.instanceMode?-this.instanceRef.floor(this.#e()*r):-floor(this.#e()*r),this.#i.frameCount=0));let m=this.#i.tX_anchor,u=this.#i.tY,M=!0,x=!0;for(i?i.blendMode(h):this.instanceMode?this.instanceRef.blendMode(h):blendMode(h);u<a;){for(;m<s;){if(o?(n?i.push():this.instanceMode?this.instanceRef.push():push(),M?x?n?i.image(e,m,u,l,f):this.instanceMode?this.instanceRef.image(e,m,u,l,f):image(e,m,u,l,f):n?(i.scale(-1,1),i.image(e,-m,u,-l,f)):(this.instanceMode?this.instanceRef.scale(-1,1):scale(-1,1),this.instanceMode?this.instanceRef.image(e,-m,u,-l,f):image(e,-m,u,-l,f)):x?n?(i.scale(1,-1),i.image(e,m,-u,l,-f)):(this.instanceMode?this.instanceRef.scale(1,-1):scale(1,-1),this.instanceMode?this.instanceRef.image(e,m,-u,l,-f):image(e,m,-u,l,-f)):n?(i.scale(-1,-1),i.image(e,-m,-u,-l,-f)):(this.instanceMode?this.instanceRef.scale(-1,-1):scale(-1,-1),this.instanceMode?this.instanceRef.image(e,-m,-u,-l,-f):image(e,-m,-u,-l,-f)),n?i.pop():this.instanceMode?this.instanceRef.pop():pop()):n?i.image(e,m,u,l,f):this.instanceMode?this.instanceRef.image(e,m,u,l,f):image(e,m,u,l,f),m+=l,m>=s){x=!0,m=this.#i.tX_anchor,u+=f;break}x=!x}M=!M}i?i.blendMode(this.instanceMode?this.instanceRef.BLEND:BLEND):this.instanceMode?this.instanceRef.blendMode(this.instanceRef.BLEND):blendMode(BLEND),n&&i.reset()}#n(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(this.#e()*(t-e+1)+e)}}
